//The logic of private routing are kept here 